"use strict";(self.webpackChunklearn_data=self.webpackChunklearn_data||[]).push([[8524],{8524:(e,l,t)=>{t.r(l),t.d(l,{default:()=>H});var s=t(9344),a=t(1804),r=t(8890),u=t(6432),i=t(3968),n=t(9160),o=t(1108),c=t(5336),v=t(8956);const h=[];t(4976);const p=(0,a.W_y)("SEARCH_PRO_QUERY_HISTORY",[]),y=e=>h[e.id]+("anchor"in e?`#${e.anchor}`:""),{resultHistoryCount:d}=v.s,m=(0,a.W_y)("SEARCH_PRO_RESULT_HISTORY",[]);var H=(0,i._M)({name:"SearchResult",props:{query:{type:String,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(e,{emit:l}){const t=(0,n.KX)(),h=(0,o.mq)(),H=(0,s.MB)(v.a),{enabled:g,addQueryHistory:f,queryHistory:k,removeQueryHistory:Q}=(()=>{const{queryHistoryCount:e}=v.s,l=e>0;return{enabled:l,queryHistory:p,addQueryHistory:t=>{l&&(p.value.length<e?p.value=Array.from(new Set([t,...p.value])):p.value=Array.from(new Set([t,...p.value.slice(0,e-1)])))},removeQueryHistory:e=>{p.value=[...p.value.slice(0,e),...p.value.slice(e+1)]}}})(),{enabled:R,resultHistory:w,addResultHistory:x,removeResultHistory:C}=(()=>{const e=d>0;return{enabled:e,resultHistory:m,addResultHistory:l=>{if(e){const e={link:y(l),display:l.display};"header"in l&&(e.header=l.header),m.value.length<d?m.value=[e,...m.value]:m.value=[e,...m.value.slice(0,d-1)]}},removeResultHistory:e=>{m.value=[...m.value.slice(0,e),...m.value.slice(e+1)]}}})(),S=g||R,q=(0,u.C7)(e,"query"),{results:_,searching:b}=(e=>{const l=(0,v.u)(),t=(0,o.mq)(),{search:s,terminate:a}=(0,v.c)(),n=(0,u.IL)(!1),c=(0,u.kl)([]);return(0,i.u2)((()=>{const u=()=>{c.value=[],n.value=!1},o=(0,r.ui)((e=>{n.value=!0,e?s({type:"search",query:e,locale:t.value,options:l}).then((e=>{c.value=e,n.value=!1})).catch((e=>{console.error(e),u()})):u()}),v.s.searchDelay);(0,i.Kg)([e,t],(()=>o(e.value)),{immediate:!0}),(0,i.wx)((()=>{a()}))})),{searching:n,results:c}})(q),A=(0,u.cB)({isQuery:!0,index:0}),I=(0,u.IL)(0),T=(0,u.IL)(0),D=(0,i.S6)((()=>S&&(k.value.length>0||w.value.length>0))),E=(0,i.S6)((()=>_.value.length>0)),L=(0,i.S6)((()=>_.value[I.value]||null)),F=e=>e.map((e=>(0,s.ct)(e)?e:(0,i.h)(e[0],e[1]))),K=e=>{if("customField"===e.type){const l=v.b[e.index]||"$content",[t,a=""]=(0,s.oF)(l)?l[h.value].split("$content"):l.split("$content");return e.display.map((e=>(0,i.h)("div",F([t,...e,a]))))}return e.display.map((e=>(0,i.h)("div",F(e))))},M=()=>{I.value=0,T.value=0,l("updateQuery",""),l("close")};return(0,a.KIJ)("keydown",(s=>{if(e.isFocusing)if(E.value){if("ArrowUp"===s.key)T.value>0?T.value-=1:(I.value=I.value>0?I.value-1:_.value.length-1,T.value=L.value.contents.length-1);else if("ArrowDown"===s.key)T.value<L.value.contents.length-1?T.value+=1:(I.value=I.value<_.value.length-1?I.value+1:0,T.value=0);else if("Enter"===s.key){const l=L.value.contents[T.value];f(e.query),x(l),t.push(y(l)),M()}}else if(R)if("ArrowUp"===s.key)(()=>{const{isQuery:e,index:l}=A;0===l?(A.isQuery=!e,A.index=e?w.value.length-1:k.value.length-1):A.index=l-1})();else if("ArrowDown"===s.key)(()=>{const{isQuery:e,index:l}=A;l===(e?k.value.length-1:w.value.length-1)?(A.isQuery=!e,A.index=0):A.index=l+1})();else if("Enter"===s.key){const{index:e}=A;A.isQuery?(l("updateQuery",k.value[e]),s.preventDefault()):(t.push(w.value[e].link),M())}})),(0,i.Kg)([I,T],(()=>{document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active")?.scrollIntoView(!1)}),{flush:"post"}),()=>(0,i.h)("div",{class:["search-pro-result-wrapper",{empty:q.value?!E.value:!D.value}],id:"search-pro-results"},""===q.value?S?D.value?[g?(0,i.h)("ul",{class:"search-pro-result-list"},(0,i.h)("li",{class:"search-pro-result-list-item"},[(0,i.h)("div",{class:"search-pro-result-title"},H.value.queryHistory),k.value.map(((e,t)=>(0,i.h)("div",{class:["search-pro-result-item",{active:A.isQuery&&A.index===t}],onClick:()=>{l("updateQuery",e)}},[(0,i.h)(c.H,{class:"search-pro-result-type"}),(0,i.h)("div",{class:"search-pro-result-content"},e),(0,i.h)("button",{class:"search-pro-remove-icon",innerHTML:c.C,onClick:e=>{e.preventDefault(),e.stopPropagation(),Q(t)}})])))])):null,R?(0,i.h)("ul",{class:"search-pro-result-list"},(0,i.h)("li",{class:"search-pro-result-list-item"},[(0,i.h)("div",{class:"search-pro-result-title"},H.value.resultHistory),w.value.map(((e,l)=>(0,i.h)(o.Qr,{to:e.link,class:["search-pro-result-item",{active:!A.isQuery&&A.index===l}],onClick:()=>{M()}},(()=>[(0,i.h)(c.H,{class:"search-pro-result-type"}),(0,i.h)("div",{class:"search-pro-result-content"},[e.header?(0,i.h)("div",{class:"content-header"},e.header):null,(0,i.h)("div",e.display.map((e=>F(e))).flat())]),(0,i.h)("button",{class:"search-pro-remove-icon",innerHTML:c.C,onClick:e=>{e.preventDefault(),e.stopPropagation(),C(l)}})]))))])):null]:H.value.emptyHistory:H.value.emptyResult:b.value?(0,i.h)(c.S,{hint:H.value.searching}):E.value?(0,i.h)("ul",{class:"search-pro-result-list"},_.value.map((({title:l,contents:t},s)=>{const a=I.value===s;return(0,i.h)("li",{class:["search-pro-result-list-item",{active:a}]},[(0,i.h)("div",{class:"search-pro-result-title"},l||H.value.defaultTitle),t.map(((l,t)=>{const s=a&&T.value===t;return(0,i.h)(o.Qr,{to:y(l),class:["search-pro-result-item",{active:s,"aria-selected":s}],onClick:()=>{f(e.query),x(l),M()}},(()=>["text"===l.type?null:(0,i.h)("title"===l.type?c.T:"heading"===l.type?c.a:c.b,{class:"search-pro-result-type"}),(0,i.h)("div",{class:"search-pro-result-content"},["text"===l.type&&l.header?(0,i.h)("div",{class:"content-header"},l.header):null,(0,i.h)("div",K(l))])]))}))])}))):H.value.emptyResult)}})}}]);